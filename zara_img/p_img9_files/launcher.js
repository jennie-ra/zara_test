(()=>{"use strict";class e extends Error{constructor(e){super(e),this.name="GetRecommendationException"}}function t(e,t){e.open?e.open(t):console.warn("Open not implemented yet")}function n(e){e.close?e.close():console.warn("Close not implemented yet")}var o,r=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};function i(t,n){return r(this,void 0,void 0,(function*(){const{ok:o,value:r}=yield t.getRecommendation(n);if(!o)throw new e("Error getting recommendation");return Promise.resolve(r)}))}!function(e){e.ON_RECOMMENDATION="onRecommendation",e.ON_ERROR="onError",e.ON_CLOSE="onClose",e.ON_ADDTOCART="onAddToCart",e.ON_IS_VISITOR_CHANGED="onIsVisitorChanged",e.ON_UPDATE_PROFILE="onUpdateProfile"}(o||(o={}));let a={};const s=[o.ON_RECOMMENDATION,o.ON_ERROR,o.ON_CLOSE,o.ON_ADDTOCART,o.ON_IS_VISITOR_CHANGED,o.ON_UPDATE_PROFILE];function c(e){const t=e=>{const t=Object.assign({},a);for(const n in e)e[n]&&(t[n]||(t[n]=e[n]));a=t};return{knownEvents:s,suscribeEvents:n=>{t(n),(t=>{Object.keys(t).forEach((n=>{e.on({name:n,listener:t[n]})}))})(n)},getEventsManager:()=>e,getEvents:()=>a}}var d;!function(e){e.SCRIPT_NOT_FOUND="Script not found",e.ADAPTER_NOT_FOUND="Adapter not found"}(d||(d={}));var u=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};class l{constructor(){this.eventsMap={},this.eventsMap={}}on({listener:e,name:t}){const n=this.eventsMap[t]||[];n.push(e),this.eventsMap[t]=n}notify({name:e,payload:t}){this.eventsMap[e]?this.eventsMap[e].forEach((e=>{e(t)})):console.warn(`Triggered ${e} event`,{payload:t})}}const m=new Set,f=new Map;var h=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};var p=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};function v(){return{loadAdapter:e=>p(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{if((e=>{const t=document.querySelectorAll("script[src]");return 0!==t.length&&Array.from(t).some((t=>t.getAttribute("src")===e))})(e))return void t();const o=document.createElement("script");o.async=!0,o.onload=function(){t()},o.onerror=e=>{document.head.removeChild(o),n(e)},o.src=e,document.head.appendChild(o)}))})),getAdapter:e=>p(this,void 0,void 0,(function*(){yield((e,t=1500)=>h(void 0,void 0,void 0,(function*(){yield new Promise(((n,o)=>{const r=Date.now(),i=()=>{window[`getWidget__${e}`]?n({}):Date.now()-r>t?o(new Error(`Timeout waiting for adapter ${e}`)):setTimeout(i,100)};i()}))})))(e);return{adapter:{adapterWidget:window[`getWidget__${e}`]()}}}))}}class g extends Error{constructor(e){super(e),this.name="GetRecommenderInfoException"}}function w(e){if(!e.name)throw function(){throw new Error("The recommender info is empty")}()}class y extends Error{constructor(e){super(e),this.name="GetRecommenderInfoException"}}var C=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};function I(e,t){return C(this,void 0,void 0,(function*(){const{ok:n,value:o}=yield e.get(t);if(!n)throw new g("Error getting recommender info");return w(o),function(e){var t;if(!(null===(t=e.recommendation)||void 0===t?void 0:t.sizeResult)&&"sastre"!==e.name.toLocaleLowerCase())throw new y("The recommender info has not recommendation and is not sastre")}(o),Promise.resolve(function(e){const t="sastre"!==e.name.toLocaleLowerCase()?"Prosinecki":"Sastre";return Object.assign(Object.assign({},e),{adapterName:t})}(o))}))}class R{}class b{constructor(e,t,n){this.recommendationCache=e,this.recommendationCallback=t,this.mapper=n}handleEvent(e){this.recommendationCache.setCachedItem(e.productType.productId,e.recommendation),this.recommendationCallback(e.productType,this.mapper(e.recommendation).getSizeResult(),this.mapper(e.recommendation).getProfile())}}class E{constructor(e){this.onCloseCallback=e}handleEvent(){this.onCloseCallback()}}class T{constructor(e){this.addToCartCallback=e}handleEvent(e){this.addToCartCallback(e.productType,e.recommendation.sizeResult)}}class O{constructor(e){this.onErrorCallback=e}handleEvent(e){this.onErrorCallback(e)}}function N(e){return{getSizeResult:function(){var t;return null!==(t=null==e?void 0:e.sizeResult)&&void 0!==t?t:null},getProfile:function(){var t,n;return{profileName:null!==(n=null===(t=null==e?void 0:e.profile)||void 0===t?void 0:t.name)&&void 0!==n?n:null}}}}var k,A,P,x,M,j,S,L,U=function(e,t,n,o,r){if("m"===o)throw new TypeError("Private method is not writable");if("a"===o&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===o?r.call(e,n):r?r.value=n:t.set(e,n),n},D=function(e,t,n,o){if("a"===n&&!o)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?o:"a"===n?o.call(e):o?o.value:t.get(e)};class F extends R{constructor(e,t,n,o,r,i,a){super(),this.config=e,this.factory=t,this.eventsHandler=n,this.recommenderAdapter=o,this.recommender=r,this.recommendationCache=i,this.sessionTokenManager=a,k.add(this),A.set(this,void 0),P.set(this,void 0),x.set(this,void 0),M.set(this,N),j.set(this,{onRecommendation:new b(this.recommendationCache,this.recommendationCallback.bind(this),D(this,M,"f")),onClose:new E(this.close.bind(this)),onAddToCart:new T(this.onAddToCartCallback.bind(this)),onError:new O(this.onErrorCallback.bind(this))}),U(this,P,this.config.callbacks,"f"),U(this,x,this.recommender.recommenderInfo.isVisitor,"f"),U(this,A,D(this,k,"m",S).call(this),"f"),D(this,k,"m",L).call(this)}getRecommendation(e){const{identity:t,visitorId:n}=this.sessionTokenManager.getTokens();D(this,A,"f").getRecommendation(Object.assign(Object.assign(Object.assign({},this.config.configValue),{recommenderName:this.recommender.recommenderInfo.name,visitorId:n,identity:t}),e)).then((t=>{t&&(this.recommender=function(e,t){return Object.assign(Object.assign({},e),{recommenderInfo:{name:e.recommenderInfo.name,recommendation:t,scripts:e.recommenderInfo.scripts}})}(this.recommender,t)),this.recommendationCallback(e,D(this,M,"f").call(this,t).getSizeResult(),D(this,M,"f").call(this,t).getProfile())})).catch((()=>{this.onErrorCallback(e)}))}open(e){if(D(this,A,"f")){const{identity:t,visitorId:n}=this.sessionTokenManager.getTokens();D(this,A,"f").open(Object.assign(Object.assign({},e),{identity:t,visitorId:n}))}}close(){D(this,A,"f").close(),this.onCloseCallback()}reconfigure({identity:e,visitorId:t}){this.sessionTokenManager.setTokens(e,t)}recommendationCallback(e,t,n){D(this,P,"f").onRecommendation(e,t,n)}onErrorCallback(e){D(this,P,"f").onError(e)}onCloseCallback(){D(this,P,"f").onClose()}onAddToCartCallback(e,t){D(this,P,"f").onAddToCart(e,t)}}A=new WeakMap,P=new WeakMap,x=new WeakMap,M=new WeakMap,j=new WeakMap,k=new WeakSet,S=function(){return this.factory.createAdapter(Object.assign(Object.assign({},this.config.configValue),{eventsManager:this.eventsHandler.getEventsManager(),knownEvents:this.eventsHandler.knownEvents,recommender:this.recommender.recommenderInfo.name,recommendationCache:this.recommendationCache,recommenderInfo:this.recommender.recommenderInfo}))},L=function(){this.eventsHandler.suscribeEvents({onRecommendation:e=>D(this,j,"f").onRecommendation.handleEvent(e),onClose:()=>D(this,j,"f").onClose.handleEvent(),onAddToCart:e=>D(this,j,"f").onAddToCart.handleEvent(e),onError:e=>D(this,j,"f").onError.handleEvent(e)})};class _{constructor(){this.implementations={}}register(e,t){this.implementations[e]=t}create(e,t){const n=this.implementations[e]||this.implementations.default;if(!n)throw new Error(`No implementation exists for the context: ${e}`);return n(t)}}new _;var W;!function(e){e[e.Continue=100]="Continue",e[e.SwitchingProtocols=101]="SwitchingProtocols",e[e.Processing=102]="Processing",e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.Accepted=202]="Accepted",e[e.NonAuthoritativeInformation=203]="NonAuthoritativeInformation",e[e.NoContent=204]="NoContent",e[e.ResetContent=205]="ResetContent",e[e.PartialContent=206]="PartialContent",e[e.MultiStatus=207]="MultiStatus",e[e.AlreadyReported=208]="AlreadyReported",e[e.IMUsed=226]="IMUsed",e[e.MultipleChoices=300]="MultipleChoices",e[e.MovedPermanently=301]="MovedPermanently",e[e.Found=302]="Found",e[e.SeeOther=303]="SeeOther",e[e.NotModified=304]="NotModified",e[e.UseProxy=305]="UseProxy",e[e.TemporaryRedirect=307]="TemporaryRedirect",e[e.PermanentRedirect=308]="PermanentRedirect",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.PaymentRequired=402]="PaymentRequired",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.MethodNotAllowed=405]="MethodNotAllowed",e[e.NotAcceptable=406]="NotAcceptable",e[e.ProxyAuthenticationRequired=407]="ProxyAuthenticationRequired",e[e.RequestTimeout=408]="RequestTimeout",e[e.Conflict=409]="Conflict",e[e.Gone=410]="Gone",e[e.LengthRequired=411]="LengthRequired",e[e.PreconditionFailed=412]="PreconditionFailed",e[e.PayloadTooLarge=413]="PayloadTooLarge",e[e.URITooLong=414]="URITooLong",e[e.UnsupportedMediaType=415]="UnsupportedMediaType",e[e.RangeNotSatisfiable=416]="RangeNotSatisfiable",e[e.ExpectationFailed=417]="ExpectationFailed",e[e.ImATeapot=418]="ImATeapot",e[e.MisdirectedRequest=421]="MisdirectedRequest",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.Locked=423]="Locked",e[e.FailedDependency=424]="FailedDependency",e[e.UpgradeRequired=426]="UpgradeRequired",e[e.PreconditionRequired=428]="PreconditionRequired",e[e.TooManyRequests=429]="TooManyRequests",e[e.RequestHeaderFieldsTooLarge=431]="RequestHeaderFieldsTooLarge",e[e.UnavailableForLegalReasons=451]="UnavailableForLegalReasons",e[e.InternalServerError=500]="InternalServerError",e[e.NotImplemented=501]="NotImplemented",e[e.BadGateway=502]="BadGateway",e[e.ServiceUnavailable=503]="ServiceUnavailable",e[e.GatewayTimeout=504]="GatewayTimeout",e[e.HTTPVersionNotSupported=505]="HTTPVersionNotSupported",e[e.VariantAlsoNegotiates=506]="VariantAlsoNegotiates",e[e.InsufficientStorage=507]="InsufficientStorage",e[e.LoopDetected=508]="LoopDetected",e[e.NotExtended=510]="NotExtended",e[e.NetworkAuthenticationRequired=511]="NetworkAuthenticationRequired"}(W||(W={}));class V extends Error{constructor(e,t){super(`Invalid status code: ${e}`),this.name="InvalidStatusCodeError",this.code=e,this.body=t}}class q extends Error{constructor(){super("Unexpected server error"),this.name="UnexpectedServerError"}}function z(e,t){return new V(e,t)}function $(e){throw e instanceof V?e:new q}var G=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};function H(e){function t(e,t,n,o,r){const i=()=>fetch(t,Object.assign(Object.assign({},o),{method:e,body:n?JSON.stringify(n):void 0})).then((t=>{if(function(e,t){return("GET"===e||"DELETE"===e)&&t.status===W.NoContent}(e,t))return Promise.resolve(null);if(!t.ok){return function(e){return G(this,void 0,void 0,(function*(){if(function(e){const t=e.headers.get("Content-Length");if(t&&null!==t&&"0"!==t)return!0;const n=e.headers.get("Content-Type");if(n&&null!==n&&""!==n.trim())return!0;const o=e.headers.get("Transfer-Encoding");return!(!o||null===o||""===o.trim())||!1===e.bodyUsed}(e))return yield e.json().then((t=>Promise.reject(z(e.status,t))));throw z(e.status)}))}(t.clone())}return t.json()})).catch((e=>{throw $(e)}));return r?r.caching((()=>i()),{url:t}):i()}return{get:function(n,o,r){return t("GET",n,o,r,e)},patch:function(e,n,o){return t("PATCH",e,n,o)},post:function(e,n,o){return t("POST",e,n,o)},put:function(e,n,o){return t("PUT",e,n,o)},delete:function(e,n,o){return t("DELETE",e,n,o)}}}function B(e,t,n){const{action:o,config:r,params:i,path:a}=t,s=function(e,t){const n=e;if(!n)return e;const o=new Headers,r=t.headersToRemove||[];for(const[e,t]of n.entries())r.map((e=>e.toLocaleLowerCase())).includes(e.toLocaleLowerCase())||o.append(e,t);return o}(null==r?void 0:r.headers,n);return e[o](a,i,Object.assign(Object.assign({},r),{headers:s,credentials:"omit"}))}var K=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};const J=Object.assign((function(e,t){const n=n=>K(this,void 0,void 0,(function*(){return B(e,n,t)})),o=(o,r,i,a)=>K(this,void 0,void 0,(function*(){return e[o](r,i,a).catch((e=>{if(function(e,t){return t.invalidCodesToRetry.includes(e)}(e.code,t))return(e=>{var t;const n=null===(t=window.prosinecki)||void 0===t?void 0:t.manager.getConfig();window.prosinecki.manager.setConfig(Object.assign(Object.assign({},n),{isSessionExpired:e}))})(!0),n({action:o,path:r,params:i,config:a});throw e}))}));function r(e){return(t,r,i)=>K(this,void 0,void 0,(function*(){if(null===(a=window.prosinecki)||void 0===a?void 0:a.manager.getConfig().isSessionExpired){return n({action:e,path:t,params:r,config:i})}return o(e,t,r,i);var a}))}return{get:r("get"),patch:r("patch"),post:r("post"),put:r("put"),delete:r("delete")}}),{defaultOptions:{invalidCodesToRetry:[403],headersToRemove:["WCToken","WCTrustedToken","Authorization"]}});function Q(e){const{hostName:t,storeId:n,version:o="1"}=e;return{value:`${t}/itxrest/${o}/returns/store/${n}`}}const X={ok:e=>({ok:!0,value:e}),error:(e,t=void 0)=>({ok:!1,error:e,value:t})};function Y(e){if(!e)return;const t=new Headers;return Object.keys(e).forEach((n=>{e[n]&&t.append(n,e[n])})),{headers:t}}const Z=[null,void 0,""];function ee(e){if(!e)return"";const t=new URLSearchParams;return Object.keys(e).forEach((n=>{Z.includes(e[n])||t.append(n,e[n])})),t}var te=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};function ne(e,t){return{get:n=>function(e,t,n){return te(this,void 0,void 0,(function*(){const{identity:o,locale:r,productId:i,visitorId:a}=n,s=`https://${e.value}/product/${i}/sizing-info?${ee({locale:r,visitorId:a})}`;return t.get(s,void 0,Y(o)).then((e=>X.ok(function(e){if(!e)return{name:"",recommendation:null,scripts:{desktop:"",mobile:"",purchase:""},isWizardAvailable:!1};const t=e.profile?{profile:{isVisitor:e.profile.isVisitor,name:e.profile.name}}:{};return Object.assign({name:e.recommender.name,recommendation:e.recommendation?Object.assign(Object.assign({},e.recommendation),t):null,scripts:e.recommender.scripts,isWizardAvailable:e.recommender.hasVisualInterface},function(e){return e?{isVisitor:e.isVisitor,profileName:e.name}:{}}(e.profile))}(e)))).catch((e=>X.error(e)))}))}(e,t,n)}}var oe=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};function re(e,t){const{locale:n}=t,{http:o,serviceUrl:r}=e;return{getRecommendation:function(e){return oe(this,void 0,void 0,(function*(){const{identity:t,isVisitor:i,productId:a,recommenderName:s,visitorId:c}=e,d=`https://${r.value}/product/${a}/recommendation?${ee({locale:n,recommender:s,visitorId:c,isVisitor:i})}`;return yield o.get(d,void 0,Y(t)).then((e=>X.ok(function(e){var t;if(e&&function(e){return"object"==typeof e&&null!==e&&"profile"in e}(e)){const{profile:t,recommendation:n}=e;return Object.assign({profile:t},n)}return{sizeResult:null!==(t=null==e?void 0:e.sizeResult)&&void 0!==t?t:null}}(e)))).catch((e=>X.error(e)))}))}}}const ie={PDP:function({hostName:e,locale:t,storeId:n}){const o={create:Q},r=o.create({hostName:e,storeId:n,version:"2"}),i=J(H(),J.defaultOptions),a=ne(r,i);return{services:{http:i,urlCreator:o},repositories:{recommendationRepository:re({http:i,serviceUrl:r},{locale:t}),recommenderInfoRepository:a}}}};function ae({productId:e}){const t={value:"PDP",condition:!0};return e?t:Object.assign(Object.assign({},t),{condition:!1})}function se({productId:e}){const t={value:"AFTERSALES",condition:!0};return e?Object.assign(Object.assign({},t),{condition:!1}):t}var ce=function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))};const de="prosinecki",ue={},le=new class{constructor(e=null,t=""){this.identity=e,this.visitorId=t}getTokens(){return{identity:this.identity,visitorId:this.visitorId}}setTokens(e,t){this.identity=e,this.visitorId=t}},me=new _,fe=new class{constructor(e){this.namespace=e,this.config={[e]:{}},this.proxy=new Proxy(window[e]||{},{set:(e,t,n)=>(e[t]=n,!0),get:(e,t)=>e[t]}),window[e]=this.proxy}addProperties(e){Object.assign(this.proxy,e)}getConfig(){return this.config[this.namespace]}setConfig(e){this.config[this.namespace]=e}}(de);var he,pe;function ve(...e){return null}function ge(e){return ue[e]}he=ie,pe=me,Object.keys(he).forEach((e=>{pe.register(e,he[e])})),fe.setConfig({recommendationCache:ue,isSessionExpired:!1,sessionTokenManager:le,serviceFactory:me}),fe.addProperties({init:function({channel:e,colorRef:o,hostName:r,identity:a,isDarkMode:s,isRtl:h,locale:p,productId:g,productRef:w,storeId:y,userId:C,visitorId:R},b=ve,E=ve){return ce(this,void 0,void 0,(function*(){const T=function(e){const t=[ae,se].find((t=>!0===t(e).condition));return t?t(e).value:""}({productId:g}),{repositories:{recommenderInfoRepository:O}}=me.create(T,{hostName:r,locale:p,storeId:y,identity:a}),N=new l,k=function({cache:e,loader:t,recommenderInfoAdapter:n,repository:o}){return{retrieveRecommender:function({identity:e,locale:t,productId:r,userId:i,visitorId:a}){return u(this,void 0,void 0,(function*(){return yield n.getRecommenderInfo(o,{identity:e,locale:t,productId:r,visitorId:a,userId:i})}))},isWidgetOnCache:function(t){return e.isOnCache(t)},retrieveWidgetFromCache:function(t){return e.getFromCache(t)},storeWidgetOnCache:function(t,n){e.storeInCache(t,n)},loadAdapterScript:function(e){return u(this,void 0,void 0,(function*(){return yield t.loadAdapter(e)}))},retrieveAdapterFromLoader:function(e){return u(this,void 0,void 0,(function*(){return yield t.getAdapter(e.toLocaleLowerCase())}))},ensureAdapterIsLoaded:e=>{var t;if(!(null===(t=null==e?void 0:e.adapter)||void 0===t?void 0:t.adapterWidget))throw new Error(d.ADAPTER_NOT_FOUND)}}}({cache:{isOnCache:e=>m.has(e)&&f.has(e),getFromCache:e=>f.get(e),storeInCache:(e,t)=>{m.add(e),f.set(e,t)}},loader:v(),repository:O,recommenderInfoAdapter:(A=I,{getRecommenderInfo:(e,t)=>A(e,t)})});var A,P;!function(e,t){le.setTokens(e,t)}(a,R);try{const{adapterName:u,isVisitor:l,isWizardAvailable:m,name:f,profileName:v,recommendation:I,scripts:E}=yield k.retrieveRecommender({identity:a,locale:p,productId:g,userId:C,visitorId:R});ue[P=f]||(ue[P]=function(){const e=new Map;return{getCachedItem:t=>e.get(t),setCachedItem:(t,n)=>{e.set(t,n)},clearCache:()=>{e.clear()},getCache:()=>e}}()),function(e){return(t,n)=>{ge(e).setCachedItem(t,n)}}(f)(g,I);const O=yield function({adapterName:e,isVisitor:o,isWizardAvailable:r,name:a,profileName:s,recommendation:u,scripts:l},m,f,h,p){return ce(this,void 0,void 0,(function*(){const{hostName:v,locale:g,storeId:w}=h,{isWidgetOnCache:y,retrieveWidgetFromCache:C}=m,I=y(a)?C(a):yield function(e,t){return ce(this,void 0,void 0,(function*(){const{ensureAdapterIsLoaded:n,loadAdapterScript:o,retrieveAdapterFromLoader:r,storeWidgetOnCache:i}=e;try{yield o(t.scripts.desktop||"")}catch(e){throw new Error(d.SCRIPT_NOT_FOUND)}const a=yield r(t.adapterName||"");return n(a),i(t.name,a),a}))}(m,{scripts:l,adapterName:e,name:a}),R=function({eventsManager:e,recommendator:o,sizeRecommenderAdapter:r},{channel:a,colorRef:s,hostName:d,isDarkMode:u,isRtl:l,locale:m,productId:f,productRef:h,storeId:p,userId:v},g){return class{constructor(w){return new F((b=Object.assign(Object.assign({channel:a,colorRef:s,hostName:d,isDarkMode:u,isRtl:l,locale:m,productId:`${f}`,productRef:h,storeId:p,userId:v,callbacks:Object.assign({},w)},function({isVisitor:e,profileName:t}){return e||t?{isVisitor:e,profileName:t}:{}}(o)),{pageContext:g}),{configValue:b,userId:b.userId,callbacks:b.callbacks,productId:b.productId}),(R=r,{createAdapter:function(e={}){const{adapter:{adapterWidget:t},adapterConfig:n}=R;return t(Object.assign(Object.assign({},n),e))}}),c(e),(y=i,C=t,I=n,{getRecommendation:(e,t)=>y(e,t),open:(e,t)=>C(e,t),close:e=>I(e)}),{recommenderInfo:o},ge(o.name),le);var y,C,I,R,b}}}({sizeRecommenderAdapter:{adapter:I.adapter,adapterConfig:{hostName:v,recommender:a,storeId:w,locale:g}},eventsManager:f,recommendator:{adapterName:e,name:a,recommendation:u,scripts:l,isVisitor:o,profileName:s}},h,p);return{provider:a,Widget:R,features:{isWizardAvailable:null!=r&&r}}}))}({name:f,adapterName:u,recommendation:I,scripts:E,isWizardAvailable:m,isVisitor:l,profileName:v},k,N,{channel:e,colorRef:o,hostName:r,identity:a,isDarkMode:s,isRtl:h,locale:p,productId:g,productRef:w,storeId:y,userId:C,visitorId:R},T);b(O)}catch(e){E({colorRef:o,productId:g,productRef:w})}}))}}),Object.defineProperty(window[de],"manager",{get:()=>fe,enumerable:!1,configurable:!1})})();